<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="/assets/main.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Data Visualization, Data Science and AI" /></head>
<body class="container" style="background-color:ghostwhite;"><header><!--</header> class="site-header" role="banner" style="background-color: white">-->
  <div class="wrapper mb-2"><a class="site-title" style="font-size: larger;" rel="author" href="https://datavizandai.github.io">Data Visualization, Data Science and AI</a>
    <a class="site-nav" rel="author" href="/about">About</a>
  </div>
</header><main class="container" aria-label="Content">
      <div >
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Streamlit Supports 5 Important Data Visualization Libraries - Which to Choose?</h1>
    <h3>We code examples using Altair, Bokeh, Plotly, Pandas Plot and Matplotlib, to illustrate the pros and cons of each one</h3>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-05-16T00:00:00+02:00" itemprop="datePublished">May 16, 2024
      </time></p>
  </header>

  <div class="row">
    <div class="col-sm-9">
      <div class="post-content e-content" itemprop="articleBody">
        <p><img src="/assets/images/streamlit5varieties/rowcharts.png" alt="" />
Imagine your organisation has decided to use Streamlit as its primary platform for showcasing data visualization applications and, to ensure a consistent look, it wants to adopt a single graphing library to be used across all applications. And, let’s say, your job is to investigate which is most appropriate.</p>

<p>You are spoiled for choice! There are 5 libraries you can use for coding your data visualizations: Altair, Bokeh, Plotly, Pyplot (Matplotlib) and Vega Lite. And Streamlit provides some native charts, as well.</p>

<p>Let’s take a look at each one and code up some commonly used charts.</p>

<p>The data that we will use is a set of price data for a pair of cryptocurrencies and from that data we will create a line chart showing the change in closing prices over a year for both currencies, a grouped bar chart showing the same data, again, for both currencies and a scatter chart with a trendline showing the correlation between the change in value of the two currencies.</p>

<p>The charts will look similar to the ones in the image above.</p>

<h3 id="the-data">The data</h3>

<p>The dataset is a simple three-column table. It tracks the closing prices of two cryptocurrencies over a 12-month period. It is not important for the exercise but the currencies are Ethereum and Bitcoin and the period is the previous 12 months from the time of writing. (The data are a matter of public record and are available from several sources. I retrieved them from <a href="[Crypto Real Time Prices &amp; Latest News - Yahoo Finance](https://finance.yahoo.com/crypto/)">Yahoo Finance</a>.)</p>

<p>Below is a screenshot of the data that we will use.</p>

<p><img src="/assets/images/streamlit5varieties/crypto-data.png" alt="" /></p>

<p>This representation of the data is <em>wide format</em> with each observation (the closing price) in its own column. For this article, this data is assumed to be in the file <em>crypto-23.csv</em> . This wide format shows the different observations (here, the closing prices) in seperate columns (headed ETH and BTC) and is entirely suitable for human readers. However, some data visualization packages require the data to be presented in <em>long</em> format where the observations are in a single column and seperate column contains a label for the observation.</p>

<p>If the data is in the form af a Pandas dataframe (which it is!), we can create a new dataframe in long format using the Pandas <code class="language-plaintext highlighter-rouge">melt()</code>function in the following Python code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cryptoL</span> <span class="o">=</span> <span class="n">cryptoW</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span>
          <span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span>
          <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div>

<p>You can look up <code class="language-plaintext highlighter-rouge">melt</code>in the <a href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">Pandas documentation</a> but basically this code creates a column called <em>value</em> which contains the values from the original columns <em>ETH</em> and <em>BTC</em>. The <em>Month</em> column remains a single column but it is expanded lengthwise to match <em>value</em> and the numbers of the months are repeated as required. A new column <em>Name</em> is created that will contain the value <em>ETH</em> or <em>BTC</em> and labels the <em>value</em> in the same row. The result can be seen in the image below.</p>

<p><img src="/assets/images/streamlit5varieties/crypto-data-long.png" alt="" /></p>

<h3 id="the-charts">The charts</h3>

<p>More specifically the charts that we want to create are:</p>

<p><em>Line chart</em>: The line chart should track both currencies over the period and show two seperate lines of different colours, one for each currency.</p>

<p><em>Bar chart</em>: the bar chart should be a grouped bar chart that tracks the two currencies over the period. The bars should be vertical and grouped such that the pair of currencies are shown next to each other in each month. The bar for each currency should be coloured differently.</p>

<p><em>Scatter chart</em>: The scatter chart should show the relationship between the closing prices of each currency and in addition show include a trendline to indicate the linearity (or otherwise) of that relationship.</p>

<p>Additionally, all charts should have a title and appropriate labels on the x and y axes.</p>

<h3 id="the-options">The options</h3>

<p>First, let’s do a quick review of the options so we can eliminate any obvious non-starters.</p>

<p><strong>Streamlit charts</strong></p>

<p>The first thing we should look at is the set of built-in functions that Streamlit provides. They will draw simple line charts, bar charts and scatter plots. And, as the documentation states, these are simply wrappers around the Altair equivalents. The documentation also suggests that if these simple charts don’t work for you, you should use the Altair charts, instead.</p>

<p>A quick look at the documentation will confirm that these charts cannot produce any of the three charts in this exercise as they cannot display more than one trace per chart. We won’t explore these any further.</p>

<p><strong>Vega-Lite</strong></p>

<p>Vega-Lite is a powerful graphing language that specifies charts in a JSON format [1]. Writing a Vega-Lite specification can be an arduous and error-prone task which is why Altair was developed. Altair is a Python library that outputs Vega-Lite specs, so If you already have Vega-Lite specifications to hand then the Vega-Lite library is the obvious one to use. But to create a chart from scratch it has to be better to use the Altair library which is a Python-friendly way of producing the same thing. We won’t explore Vega-Lite any further, either.</p>

<p><strong>The rest</strong></p>

<p>The remaining libraries are all powerful and Python-friendly ways of producing sophisticated charts and these we will explore further. But we’ll look at one of the libraries in two ways.</p>

<p>Streamlit’s <code class="language-plaintext highlighter-rouge">st.pyplot()</code>function is a way of displaying Matplotlib figures but, of course, there are other plotting libraries that are built on Matplotlib: Seaborn, Plotnine and Pandas Plots, for example. To show how we can use these we will include a version of the graphs created with Pandas Plots in addition to those created directly in Matplotlib.</p>

<p>So, we will create the three graphs in each of Altair, Bokeh, Matplotlib, Pandas Plots and Plotly.</p>

<h3 id="altair">Altair</h3>

<p>Altair[3] is a graphing library based on the concept of the Grammar of Graphics [2]. Instead of implementing specific chart types, with Altair you start with the data and then decide how that data should be mapped onto the various aspects of a graphical representation. (For a more detailed look at Altair, please see my article <a href="https://medium.com/towards-data-science/altair-and-the-powerful-vega-lite-grammar-of-graphics-d1d864c3e08e">Mastering Data Visualizaton with Altair’s Grammar of Graphics</a>.)</p>

<p>To implement the three graphs we first need to included the libraries and import the data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">altair</span> <span class="k">as</span> <span class="n">alt</span>

<span class="n">cryptoW</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">crypto-23.csv</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cryptoL</span> <span class="o">=</span> <span class="n">cryptoW</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span>
          <span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div>

<p>We import the Streamlit package, of course, along with Pandas and Altair. The data is in a <em>CSV</em> file and, as you can see we import the <em>wide</em> version in <code class="language-plaintext highlighter-rouge">cryptoW</code>,  and then create a <em>long</em> version of the data in the variable <code class="language-plaintext highlighter-rouge">cryptoL</code>.</p>

<p>To create any Altair chart we start with the code <code class="language-plaintext highlighter-rouge">alt.Chart()</code>, pass it the data and then map the data onto the various parts of the chart. The code for the line chart follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">alt</span><span class="p">.</span><span class="nc">Chart</span><span class="p">(</span><span class="n">cryptoL</span><span class="p">,</span> 
                <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> 
                <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">Cryptocurrency closing prices</span><span class="sh">'</span>
                <span class="p">).</span><span class="nf">mark_line</span><span class="p">().</span><span class="nf">encode</span><span class="p">(</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Month:O</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">value:Q</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Name:N</span><span class="sh">'</span><span class="p">)</span>

<span class="n">st</span><span class="p">.</span><span class="nf">altair_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>We specify the dataframe that we are going to use as a parameter (there are other parameters that we could include, here we set the title and width). The <code class="language-plaintext highlighter-rouge">mark_line()</code> method specifies that we want the data represented as a line and the encodings that follow determine the way the data is mapped onto the chart: the month is on the <code class="language-plaintext highlighter-rouge">x</code> axis, the value on the <code class="language-plaintext highlighter-rouge">y</code>axis and the <code class="language-plaintext highlighter-rouge">color</code>is specified by the name of the currency. Note that the codes appended to the names of the data fields are Altair types, <code class="language-plaintext highlighter-rouge">O</code>is ordinal, <code class="language-plaintext highlighter-rouge">Q</code>is qualitative and <code class="language-plaintext highlighter-rouge">N</code>is nominal.</p>

<p>The resulting graph is shown below. (In this rendition, the text is not very easy to see but the title, x and y label and the legend are perfectly visible in the Streamlit app).</p>

<p><img src="/assets/images/streamlit5varieties/alt-line.png" alt="" /></p>

<p>So, tick! That’s our first graph completed. Let’s do the other two.</p>

<p>The grouped bar chart code is very similar. This time we use the method <code class="language-plaintext highlighter-rouge">mark_bar</code>. Without any modification this will gives is a stacked bar chart but by specifying an x offset, we can shift the bars sideways and thereby produce a grouped chart.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">alt</span><span class="p">.</span><span class="nc">Chart</span><span class="p">(</span><span class="n">cryptoL</span><span class="p">,</span> 
                <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">Cryptocurrency closing prices</span><span class="sh">'</span>
                <span class="p">).</span><span class="nf">mark_bar</span><span class="p">().</span><span class="nf">encode</span><span class="p">(</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Month:O</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">value:Q</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Name:N</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">xOffset</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Name:N</span><span class="sh">'</span><span class="p">)</span>

<span class="n">st</span><span class="p">.</span><span class="nf">altair_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>You can see the result below (the earlier comment applies to the text here, too).</p>

<p><img src="/assets/images/streamlit5varieties/alt-bar.png" alt="" /></p>

<p>The scatter chart is slightly more complicated because we want to include a trendline</p>

<p>The code below is very similar to the other charts but here we use the wide form of the data and the method <code class="language-plaintext highlighter-rouge">mark_point()</code>. The x and y data are the two currencies.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">alt</span><span class="p">.</span><span class="nc">Chart</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">,</span> 
                <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">Cryptocurrency closing prices</span><span class="sh">'</span>
                <span class="p">).</span><span class="nf">mark_point</span><span class="p">().</span><span class="nf">encode</span><span class="p">(</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p>As it stands that code would be sufficient to draw a scatter chart. To add the trendline we need to do a little more work.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">trend</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">transform_regression</span><span class="p">(</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">).</span><span class="nf">mark_line</span><span class="p">()</span>
</code></pre></div></div>

<p>Altair has built-in transform functions and here we use the function <code class="language-plaintext highlighter-rouge">transform_regression()</code>to create a line chart of <code class="language-plaintext highlighter-rouge">ETH</code>versus <code class="language-plaintext highlighter-rouge">BTC</code>.</p>

<p>To combine the two charts we simply ‘add’ them together.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">st</span><span class="p">.</span><span class="nf">altair_chart</span><span class="p">(</span><span class="n">fig</span> <span class="o">+</span> <span class="n">trend</span><span class="p">)</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">+</code> operator combines the two graphs placing one on top of the other resulting in the following chart.</p>

<p><img src="/assets/images/streamlit5varieties/alt-scatter1.png" alt="" /></p>

<p>That is correct but not ideal. It would be better if we could ignore the left side of the chart that is blank. We can fix this with the longer version shown below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">alt</span><span class="p">.</span><span class="nc">Chart</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">,</span> 
                <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">Cryptocurrency closing prices</span><span class="sh">'</span>
                <span class="p">).</span><span class="nf">mark_point</span><span class="p">().</span><span class="nf">encode</span><span class="p">(</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="p">.</span><span class="nc">X</span><span class="p">(</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="p">.</span><span class="nc">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">20000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">])),</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">)</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">transform_regression</span><span class="p">(</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">).</span><span class="nf">mark_line</span><span class="p">()</span>

<span class="n">st</span><span class="p">.</span><span class="nf">altair_chart</span><span class="p">(</span><span class="n">fig</span> <span class="o">+</span> <span class="n">trend</span><span class="p">)</span>
</code></pre></div></div>

<p>This is fundamentally the same chart but we have specified the x axis in a different way (using the <code class="language-plaintext highlighter-rouge">alt.X()</code> function). By doing this we can pass values for the scale and here we specify that the x scale should begin at 20000 and end at 70000. This code gives us a better rendition.</p>

<p><img src="/assets/images/streamlit5varieties/alt-scatter2.png" alt="" /></p>

<p>We have completed the first task. Altair has givens us perfectly good charts with not too much effort.</p>

<h3 id="bokeh">Bokeh</h3>

<p>The Bokeh library has a similar feel to Altair in that it starts with  a figure object and builds the chart chat that. But the figure specifies mostly decorative elements of the chart. The graphical elements are built on top as attributes to the figure object.</p>

<p>Here’s the initial code that imports the library and the data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span>

<span class="n">cryptoW</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">crypto-23.csv</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>Now we add a figure with some textual attributes.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span> <span class="o">=</span> <span class="nf">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Line chart ETH and BTC prices</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">x_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">y_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">Value (USD)</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>To this initial figure we can add graphical elements such as lines. The next piece of code adds line graphs for the two currencies.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="p">.</span><span class="nf">line</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">],</span> 
    <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> 
    <span class="n">legend_label</span><span class="o">=</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">,</span> 
    <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">line</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">],</span> 
    <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">],</span> 
    <span class="n">legend_label</span><span class="o">=</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">,</span> 
    <span class="n">color</span> <span class="o">=</span> <span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">legend</span><span class="p">.</span><span class="n">location</span> <span class="o">=</span> <span class="sh">"</span><span class="s">top_left</span><span class="sh">"</span>

<span class="n">st</span><span class="p">.</span><span class="nf">bokeh_chart</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></div>

<p>As you can see the <code class="language-plaintext highlighter-rouge">line()</code>function is invoked twice, once for each of the currencies (with appropriate labels, colours and line width) and we (optionally) change the default position of the legend to the top left so that it doesn’t obscure the lines in the graph.</p>

<p>Below we can see the resulting graph.</p>

<p><img src="/assets/images/streamlit5varieties/bokeh_line.png" alt="" /></p>

<p>The result is, of course, similar to the Altair version but with a different style.</p>

<p>The grouped bar chart is very similar but uses the <code class="language-plaintext highlighter-rouge">vbar()</code>function to plot the data, and like the Altair version would default to a stacked bar. With Bokeh we can use <code class="language-plaintext highlighter-rouge">dodge()</code>as a parameter which shifts the bars horizontally. First, we set a width for the bars (a full bar would have a width of 1 but since there are two bars they should be a maximum of 0.5 each. Here we set them to 0.4 so there is a gap between them). We then we use the width divided by 2 to set the offset for each bar.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">bokeh.transform</span> <span class="kn">import</span> <span class="n">dodge</span>
<span class="n">p</span> <span class="o">=</span> <span class="nf">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Grouped bar</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">x_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">y_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">Value (USD)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">p</span><span class="p">.</span><span class="nf">vbar</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="nf">dodge</span><span class="p">(</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> 
    <span class="n">legend_label</span><span class="o">=</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="n">cryptoW</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span>
<span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">vbar</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="nf">dodge</span><span class="p">(</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> 
    <span class="n">legend_label</span><span class="o">=</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="n">cryptoW</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span>
<span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">legend</span><span class="p">.</span><span class="n">location</span> <span class="o">=</span> <span class="sh">"</span><span class="s">top_left</span><span class="sh">"</span>
<span class="n">st</span><span class="p">.</span><span class="nf">bokeh_chart</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></div>

<p>The chart is show below.</p>

<p><img src="/assets/images/streamlit5varieties/bokeh_bar.png" alt="" /></p>

<p>Finally, we need to draw the scatter plot. We start by defining the figure as before and then creating a simple scatter plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span> <span class="o">=</span> <span class="nf">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Scatter chart BTC/ETH</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">x_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">,</span> 
          <span class="n">y_axis_label</span><span class="o">=</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">,</span>
          <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>

<span class="n">p</span><span class="p">.</span><span class="nf">circle</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> 
</code></pre></div></div>

<p>We set the point size in the scatter plot to 0.8 which is appropriate for this chart. And then we create a line chart which is the trendline. We create the trendline using Numpy to determine the cooefficients for a first level regression plot and then create a new column in the dataframe from that.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add trend line to scatter plot
</span><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="c1"># Calculate regression params
</span><span class="n">m</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">polyfit</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span><span class="p">,</span> <span class="n">cryptoW</span><span class="p">.</span><span class="n">ETH</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add a trendline to the dataframe
</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">"</span><span class="s">trendline</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span>  <span class="n">y</span> <span class="ow">in</span>  <span class="n">m</span><span class="o">*</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span> <span class="o">+</span> <span class="n">b</span><span class="p">]</span>

<span class="n">p</span><span class="p">.</span><span class="nf">line</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> 
      <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">trendline</span><span class="sh">'</span><span class="p">],</span>  
      <span class="n">color</span> <span class="o">=</span> <span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">,</span>
       <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">st</span><span class="p">.</span><span class="nf">bokeh_chart</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></div>

<p>When this line is added to the chart we get the following figure.</p>

<p><img src="/assets/images/streamlit5varieties/bokeh_scatter.png" alt="" /></p>

<p>Again, a perfectly adequate chart.</p>

<h3 id="matplotlib">Matplotlib</h3>

<p>Like many libraries, Matplotlib gives us a set of basic chart types to choose from and then provides a set of functions that can modify that chart.</p>

<p>Matplotlib requires you to engage with your charts at a fairly low level but in doing this gives you a lot of control over the result.</p>

<p>For Matplotlib we will use only the wide format data. Here’s the intial code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">cryptoW</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">crypto-23.csv</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>And let’s see the code for the line chart.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">],</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">],</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Closing value (USD)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC/ETH performance</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">([</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">])</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>We first define a Matplotlib plot in the first line of code. This gives us two variables that will contain the final figure and the axes that are elements of that figure.</p>

<p>I hope you can see that using Matplotlib we simply build a plot with a series of statements. First, we create the line plots for the two currencies (the Matplotlib functio <code class="language-plaintext highlighter-rouge">plot()</code>creates a line plot for the x and y data provided).</p>

<p>And following that, we specifiy the textual properties of the plot and the legend.</p>

<p>The line plot is shown below.</p>

<p><img src="/assets/images/streamlit5varieties/plt-line.png" alt="" /></p>

<p>The bar chart is very similar. In the code below we specify the width of a bar and set the individual to that width but shifting it horizontally by adding or subtracting half of the column width. This gives us the grouped chart that we want and is a similar technique to the ones we’ve seen earlier.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.45</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">]</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Closing value (USD)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC/ETH performance</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">([</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">])</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>The result can be seen below.</p>

<p><img src="/assets/images/streamlit5varieties/plt-bar.png" alt="" /></p>

<p>A next, of course, the scatter diagram.</p>

<p>Again the code is similar to create the initial scatter plot. After that, we determine the cooeficients for a regression line with Numpy (as above) and create a trendline column in the dataframe. A line plot is created from that trendline and added to the figure.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC/ETH correlation</span><span class="sh">"</span><span class="p">)</span>

<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">m</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">polyfit</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span><span class="p">,</span> <span class="n">cryptoW</span><span class="p">.</span><span class="n">ETH</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add a trendline to the dataframe
</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">"</span><span class="s">trendline</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span>  <span class="n">y</span> <span class="ow">in</span>  <span class="n">m</span><span class="o">*</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span> <span class="o">+</span> <span class="n">b</span><span class="p">]</span>
<span class="n">st</span><span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span> <span class="n">cryptoW</span><span class="p">[</span><span class="sh">'</span><span class="s">trendline</span><span class="sh">'</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">BTC/ETH correlation</span><span class="sh">"</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>The resulting figure is shown below.</p>

<p><img src="/assets/images/streamlit5varieties/plt-scatter.png" alt="" /></p>

<p>Matplotlib is a fairly low level charting package and other, higher level, packages have been created on top of this library and we will look at one of these next.</p>

<h3 id="pandas-plots">Pandas Plots</h3>

<p>Pandas incorporates plotting functions and it is simply a matter of using the appropriate method on a dataframe to create a chart.</p>

<p>The initial code is the same as Matplotlib because we are using exactly the same packages.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">cryptoW</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">crypto-23.csv</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>And we also need to define the <code class="language-plaintext highlighter-rouge">fig</code>and <code class="language-plaintext highlighter-rouge">ax</code>variables in the same way as we did with Mathplotlib. Below is the code to produce a line chart for just the ETH prices.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ETH line chart
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">cryptoW</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">ETH values</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>You can see that we call a method on the dataframe itself <code class="language-plaintext highlighter-rouge">plot()</code>, this will produce a line chart from the parameters given. Note that it is important that we refer to the <code class="language-plaintext highlighter-rouge">ax</code> variable in the call - this effectively adds the new line plot to the figure that we defined at the beginning.</p>

<p>With Pandas Plots we can specify any number of <code class="language-plaintext highlighter-rouge">y</code>variables by passing a list as a parameter. So, to plot a line chart for both ETH and BTC the code is almost identical.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">cryptoW</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC and ETH values</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>This code is a little shorter than the Matplotlib code as Pandas makes assumptions about the names of the axes - it takes them from the column name by default although you can change this if you wish. The line chart is shown below.</p>

<p><img src="/assets/images/streamlit5varieties/pyplot-line.png" alt="" /></p>

<p>The grouped bar code is almost identical except for the name of the method to be called; here it is <code class="language-plaintext highlighter-rouge">plot.bar()</code>rather than simply <code class="language-plaintext highlighter-rouge">plot()</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">cryptoW</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">,</span> 
                 <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC and ETH values</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>We don’t need to mess around with the positioning of the bars in order to create a grouped set of bars, Pandas defaults to creating a grouped representation when given a list of <code class="language-plaintext highlighter-rouge">y</code>values.</p>

<p><img src="/assets/images/streamlit5varieties/pyplot-bar.png" alt="" /></p>

<p>To create a simple scatter plot we use the method <code class="language-plaintext highlighter-rouge">plot.scatter()</code>and otherwise the code is very similar to the other charts. However, to add the trendline we need to create a separate plot.</p>

<p>Below is the code to create the basic scatter plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">cryptoW</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span> 
                          <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC and ETH values</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>As you see it is again very similar to the preceding code. To add the trendline we create a new column in the dataframe as we did previously.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">polyfit</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span><span class="p">,</span> <span class="n">cryptoW</span><span class="p">.</span><span class="n">ETH</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add a trendline to the dataframe
</span><span class="n">cryptoW</span><span class="p">[</span><span class="sh">"</span><span class="s">trendline</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span>  <span class="n">y</span> <span class="ow">in</span>  <span class="n">m</span><span class="o">*</span><span class="n">cryptoW</span><span class="p">.</span><span class="n">BTC</span> <span class="o">+</span> <span class="n">b</span><span class="p">]</span>
</code></pre></div></div>

<p>Now we can plot a line form this new column and by including the existing axis <code class="language-plaintext highlighter-rouge">ax</code>, we add this new plot line to the existing figure.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cryptoW</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">trendline</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>And when we plot the figure we get the scatter plot with the trendline as we see below.</p>

<p><img src="/assets/images/streamlit5varieties/pyplot-scatter.png" alt="" /></p>

<p>Pandas plots gives you all of the flexibility of Matplotlib as you can still use the Matplotlib library to modify the figure using the <code class="language-plaintext highlighter-rouge">plt.*</code>methods but the syntax for plotting is a little cleaner when using a Pandas dataframe as the source of the plotting data.</p>

<h3 id="plotly">Plotly</h3>

<p>Plotly has both high level and low level functions - Plotly Express is the recommended library as it incorporates a large number of standard charts, whereas lower level functions are provided by the Plotly Graphic Objects (GO) part of the package. Plotly, themselves, suggest that you use Plotly Express, which is built upon Plotly GO, and that is what we will do.</p>

<p>Plotly is generally better used with long format data, so our initial code includes the generation of this form of the data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">plotly.express</span> <span class="k">as</span> <span class="n">px</span>

<span class="n">cryptoW</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">crypto-23.csv</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cryptoL</span> <span class="o">=</span> <span class="n">cryptoW</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">ETH</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">BTC</span><span class="sh">'</span><span class="p">],</span>
                       <span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div>

<p>Creating a line chart from the long data is achieved in a single line of code. Below we see that line and how it is plotted.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="nf">line</span><span class="p">(</span><span class="n">cryptoL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC and ETH values</span><span class="sh">'</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">plotly_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">))</span>
</code></pre></div></div>

<p>By specifiying the <code class="language-plaintext highlighter-rouge">y</code>value to be the <code class="language-plaintext highlighter-rouge">value</code>column we tell the function which data to use for the line chart and by including the <code class="language-plaintext highlighter-rouge">color</code> parameter, we ensure that we have seperate coloured lines (in this case one for each name). We set the name of the figure as a parameter - the axis labels are taken care of automatically.</p>

<p><img src="/assets/images/streamlit5varieties/plotly-line.png" alt="" /></p>

<p>The bar graph is equally easy and follows the same pattern. The default bar chart is a stacked one but we simply set the <code class="language-plaintext highlighter-rouge">barmode</code> parameter to <code class="language-plaintext highlighter-rouge">'group'</code>to get the grouped representation.</p>

<p>Again we create the figure in a single line of code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">cryptoL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">"</span><span class="s">Month</span><span class="sh">"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">Name</span><span class="sh">"</span><span class="p">,</span> 
             <span class="n">barmode</span><span class="o">=</span><span class="sh">'</span><span class="s">group</span><span class="sh">'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">BTC and ETH values</span><span class="sh">'</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">plotly_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>And the resulting figure is shown below.</p>

<p><img src="/assets/images/streamlit5varieties/plotly-bar.png" alt="" /></p>

<p>When is comes to the scatter chart, Plotly provides built in trendline functionality. This require the inclusion of the <em>statsmodels</em> library which, while not imported, must be installed.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">cryptoW</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">"</span><span class="s">ETH</span><span class="sh">"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="sh">"</span><span class="s">BTC</span><span class="sh">"</span><span class="p">,</span> 
                 <span class="n">trendline</span><span class="o">=</span><span class="sh">"</span><span class="s">ols</span><span class="sh">"</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">'</span><span class="s">ETH/BTC values</span><span class="sh">'</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="nf">plotly_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p>In the code above we see the familiar pattern of a Plotly plot - and additional parameter <code class="language-plaintext highlighter-rouge">trendline</code>  will ensure that the regression line is calculated and drawn with no effort on the programmer’s part.</p>

<p><img src="/assets/images/streamlit5varieties/plotly-scatter.png" alt="" /></p>

<p>That completes the set of charts for Plotly and for the whole exercise.</p>

<h3 id="so-where-does-that-leave-us">So, where does that leave us</h3>

<p>In terms of what the charts shows us, the line and bar charts illustrate the prices for these cryptocurrencies being pretty volatile and the scatter charts confirm what we can also see in the other charts that the two currencies tend to go up and down together - general sentiment about cryptocurrencies probably affects the value of most, if not all, of them.</p>

<p>But what about the libraries.</p>

<p>All of the libraries do a reasonable job although you might find some charts more attractive than others - the Matplotlib charts look a little more clunky than the others, for example (although this may mainly to do with the large font which can be easily changed with a little extra code, for example, <code class="language-plaintext highlighter-rouge">matplotlib.rcParams['font.size'] = 8</code> will reduce the size of all off the text in a figure and this being a global setting will affect all plots that are created after it is executed).</p>

<p>With a little effort you can customize any of the charts that we’ve looked at either by adjusting particular aspcts of a plot such as the height and width, or by adopting a different style sheet.</p>

<p>What is important ot the programmer, of course, is the ease with which you can code these figures. It’s fair to say that the library that has the most compact code is Plotly Express, followed closely by Pandas Plots. With Altair, Bokeh and Matplotlib you need to do a little more work though working with any of the packages is fairly straightforward.</p>

<p>Another thing that might  sway your decision is the philosophy behind the libraries.</p>

<p>Altair uses a Grammar of Graphics approach where you decide what you want to do with the data, whereas the others tend to favour solutions to standard problems by including a fixed library of chart types.</p>

<p>Matplotlib makes you build your charts from the bottom up and has a whole bunch of methods for adjusting and customizing graphs. Pandas Plots simplifies the Matplotlib approach but maintains its flexibility -  Matplotlib parameters and functions work with Pandas charts, too.</p>

<p>Bokeh, again, provides a lot of flexibility with the downside that you need to write a little more code than in other libraries.</p>

<p>Plotly, last but not least, provides a large number of fixed chart types and they are each customizable. If compact code is important then Plotly is probably the winner in this respect.</p>

<p>The decision is yours (or your organisation’s). I could have simply stated my own preference at the beginning but the purpose of showing you the code is so you can judge for yourself.</p>

<hr />

<p>Thanks for reading and I hope this has been helpful. You can find all of the above code and data in the <a href="https://github.com/alanjones2/streamlit-chart-varieties/tree/main/code">GitHub repo</a>) for this article in the form of Streamlit programs. Feel free to download them for your reference.</p>

<p>To see more articles like this you can subscribe on <a href="https://medium.com/@alan-jones/subscribe">Medium</a>, subscribe to my free and occasional <a href="technofile.substack.com">newsletter</a> or visit my <a href="alanjones2.github.io">website</a>.</p>

<hr />

<h3 id="notes">Notes</h3>

<ol>
  <li>
    <p><a href="http://vis.csail.mit.edu/pubs/vega-lite">Vega-Lite: A Grammar of Interactive Graphics</a>, Arvind Satyanarayan, Dominik Moritz, Kanit Wongsuphasawat and Jeffrey Heer, <em>IEEE Transactions on Visualization &amp; Computer Graphics (Proc. IEEE InfoVis)</em>, 2017</p>
  </li>
  <li>
    <p>Leland Wilkinson’s seminal, The Grammar of Graphics (Statistics and Computing) 2nd Edition (2005), is listed on <a href="https://amzn.to/3HVR3mS">Amazon</a>. It’s not cheap!</p>
  </li>
  <li>
    <p><a href="https://joss.theoj.org/papers/10.21105/joss.01057">Altair: Interactive Statistical Visualizations for Python</a>, Jacob VanderPlas, et al. _Journal of Open Source Software, 3(32), 1057</p>
  </li>
</ol>

<p><em>Links to Amazon are affiliate links which means if you purchase something I may get a small commission but it will not affect the price you pay</em></p>

<p>All images and screenshots are by me, the author, unless otherwise noted.</p>

      </div>
    </div>
    <div class="col-sm-3">
      Sponsored content
    <!--ads etc here -->
    <!-- streamlit from scratch-->
    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
        <div>
            <i>eBook</i>
            <img class="mr-3" src="" width='80%' height='auto' alt="">
            <h5>
                <a href="https://alanjones2.github.io/streamlitfromscratch/" target="_blank">
                    <span class="text-dark">Streamlitfrom Scratch</span>
                </a>
            </h5>
            <p><b>Streamlit</b> is a framework for creating Data Science apps in Python.
                <br />
                <b>Streamlit from Scratch</b> is an ebook that will teach you how to get started with
                Streamlit.
            </p>

        </div>
    </div>

    <!-- google add start-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <!-- google add end-->


    <!-- how charts work-->
    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
        <div>
            <i>Sponsored content</i>
            <img class="mr-3" src="https://m.media-amazon.com/images/I/61y5lxsc9DL._SY466_.jpg" width='80%'
                height='auto' alt="">
            <h5 class="mt-0">
                <a href="https://amzn.to/47FKuiz" target="_blank">
                    <span class="text-dark">How Charts Work: Understand and explain data with
                        confidence</span>
                </a>
            </h5>
            <h6>From the Back Cover</h6>
            <p>
                How Charts Work brings the secrets of effective data visualisation in a way that will
                help you bring data alive.
                Charts, graphs and tables are essential devices in business, but all too often they
                present information poorly.
                This
                book will help you:

                <li>Feel confident understanding different types of charts, graphs and tables – and how
                    to read them</li>
                <li>Recognise the true story behind the data presented and what the information really
                    shows</li>
                <li>Know the principles and rules of how best to represent information so you can create
                    your own
                    information-driven (and
                    beautiful) visuals</li>
                <li>Design visuals that people engage with, understand and act upon</li>
            </p>

        </div>
    </div>
    <!-- google add start-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <!-- google add end-->

    <!-- the art of statistics-->
    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
        <div>
            <i>Sponsored content</i>
            <img class="mr-3" src="https://m.media-amazon.com/images/I/61eFjiH7sIL._SY264_BO1,204,203,200_QL40_ML2_.jpg"
                width='80%' height='auto' alt="">
            <h5 class="mt-0">
                <a href="https://amzn.to/3kVBGmo" target="_blank">
                    <span class="text-dark">The Art of Statistics: How to Learn from Data</span>
                </a>
            </h5>
            Discover how data literacy is changing the world and gives you a better understanding of
            life's biggest problems. I have used this book in various articles and found it to be
            invaluable.

        </div>
    </div>

    <!-- google add start-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <!-- google add end-->

    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">

        <i>eBook</i>
        <h5><a href='https://alanjones.gumroad.com/l/auiws' target='_blank'>Plotting with Pandas</a>
        </h5>
        <p>
            <b>Plotting with Pandas: an Introduction to Data Visualization</b> is an ebook that covers basic and
            statistical plots using Python and Pandas, line and bar charts, scatter plots, pie charts,
            histograms, box plots, etc.
        </p>



    </div>

    <!-- google add start-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <!-- google add end-->

    <!-- storytelling in data-->
    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
        <div>
            <i>Sponsored content</i>
            <img class="mr-3" src="https://m.media-amazon.com/images/I/41OonY0kRWL._SX399_BO1,204,203,200_.jpg"
                width='80%' height='auto' alt="">
            <h5 class="mt-0">
                <a href="https://amzn.to/3JmzEFq" target="_blank">
                    <span class="text-dark">Storytelling with Data: A Data Visualization Guide for
                        Business</span>
                </a>
            </h5>
            Don't simply show your data - tell a story with it! Storytelling with Data teaches you
            the fundamentals of data visualization and how to communicate effectively with data. I
            use this book in the series of articles '12 Essential Visualizations and How to
            Implement them.

        </div>
    </div>

    <!-- google add start-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <!-- google add end-->

    <!-- How charts lie -->
    <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
        <div>
            <i>Sponsored content</i>
            <img class="mr-3" src="https://m.media-amazon.com/images/I/41N21MzfCRL._SX329_BO1,204,203,200_.jpg"
                width='80%' height='auto' alt="">
            <h5 class="mt-0">
                <a href="https://amzn.to/3ZuQO9B" target="_blank">
                    <span class="text-dark">How Charts Lie: Getting Smarter about Visual
                        Information</span>
                </a>
            </h5>
            A leading data visualization expert explores the negative - and positive - influences
            that charts have on our perception of truth. I used this book as the inspiration for
            'How Not to Lie with Charts'.

        </div>
    </div>


    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>
    <!-- sfs vertical -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <div id="amzn-assoc-ad-d5bf4dcd-55c6-4038-a3d8-ff8bfa49de8a"></div>
    <script async
        src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=d5bf4dcd-55c6-4038-a3d8-ff8bfa49de8a"></script>

</div>

  </div><a class="u-url" href="/2024/05/16/streamlit-five-varieties.html" hidden></a>
</article>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

  </body>

</html>
